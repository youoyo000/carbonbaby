<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>ç¢³è¶³è·¡æ—¥è¨˜ - å¡«å¯«æ—¥è¨˜</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      background: #f8fafc;
    }
    /* è®“ container ä¸è¦è²¼é ‚ï¼Œç¨å¾®ç•™ä¸€é»ç©ºé–“ */
    .container.diary {
      width: 100%;
      max-width: 1200px;
      margin: 40px auto 0 auto;
      padding: 0 12px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    /* å¡ç‰‡å€2è¡Œ6åˆ—æ­£æ–¹å½¢ï¼Œå¯¬åº¦æœ€å¤§1080pxï¼Œæ‰‹æ©Ÿ1è¡Œ12åˆ—ä¸”éæ­£æ–¹å½¢ */
    .diary-cards {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      grid-template-rows: repeat(2, 1fr);
      gap: 20px 28px;
      margin-bottom: 18px;
      width: 100%;
      max-width: 1080px;
    }
    .diary-card {
      aspect-ratio: 1/1;
      width: 100%;
      background: linear-gradient(100deg,#f3f9f7 80%,#e0f2f1 100%);
      border-radius: 18px;
      box-shadow: 0 2px 10px #81c78422;
      border: 2.5px solid #f3f9f7;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transition: border .18s, box-shadow .18s, background .18s;
      cursor: pointer;
      position: relative;
      min-width: 0;
      min-height: 0;
      padding: 0;
      user-select: none;
    }
    .diary-card.selected {
      background: linear-gradient(100deg,#e8f5e9 70%,#f3e5f5 100%);
      border-color: #43a04744;
      box-shadow: 0 6px 18px #43a04722;
    }
    .diary-card .emoji {
      font-size: 2.5em;
      margin-bottom: 9px;
      filter: drop-shadow(0 1px 1px #b2dfdb88);
      pointer-events: none;
      user-select: none;
    }
    .diary-card .label {
      font-size: 1.13em;
      color: #226746;
      font-weight: 700;
      text-align: center;
      margin: 0;
      pointer-events: none;
      user-select: none;
      word-break: break-all;
      padding: 0 6px;
    }
    .diary-card input[type="checkbox"] {
      display: none !important;
    }
    .diary-card:not(.selected):hover {
      background: #f1f8e9;
      border-color: #81c784;
    }
    .diary-char-area {
      width: 100%;
      height: 0;
      position: relative;
      z-index: 2;
      max-width: 1080px;
    }
    .diary-char-area .char-emoji {
      font-size: 2.2em;
      position: absolute;
      top: -24px;
      left: 50%;
      transform: translateX(-50%);
      pointer-events: none;
      transition: left .5s cubic-bezier(.4,0,.2,1);
      z-index: 4;
      user-select: none;
      filter: drop-shadow(0 2px 6px #e0f2f1);
    }
    .diary-progress-bg {
      width: 100%;
      max-width: 1080px;
      background: #e0f2f1;
      height: 22px;
      border-radius: 12px;
      margin-bottom: 18px;
      overflow: hidden;
      position: relative;
      z-index: 1;
    }
    .diary-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #81c784 60%, #ffd54f 100%);
      width: 0%;
      transition: width 0.35s;
    }
    .diary-tip-bar {
      background: #fffde7;
      border-left: 5px solid #ffd54f;
      padding: 10px 15px;
      border-radius: 0 10px 10px 0;
      font-size: 1em;
      color: #795548;
      margin-bottom: 13px;
      min-height: 32px;
      display: flex; align-items: center; gap: 7px;
      width: 100%;
      max-width: 1080px;
    }
    .diary-tip-bar .tip-emoji {font-size:1.2em;}
    .btn.diary-submit {
      background: linear-gradient(90deg, #43a047 70%, #ffd54f 100%);
      color: #fff;
      padding: 13px 0;
      width: 100%;
      max-width: 1080px;
      border: none;
      border-radius: 8px;
      font-size: 1.18em;
      font-weight: bold;
      margin-top: 18px;
      box-shadow: 0 2px 8px rgba(51,124,91,0.11);
      cursor: pointer;
      transition: background 0.2s;
      margin-bottom: 9px;
      display: block;
    }
    .btn.diary-submit:hover {
      background: linear-gradient(90deg, #2e7031 70%, #ffd54f 100%);
    }
    .back-link {
      display: block;
      text-align: right;
      color: #388e3c;
      text-decoration: underline;
      margin-top: 12px;
      font-size: 1.05em;
      width: 100%;
      max-width: 1080px;
    }
    /* éŸ¿æ‡‰å¼ï¼šæ‰‹æ©Ÿæ™‚å¡ç‰‡å€1è¡Œ12åˆ—ï¼Œå¡ç‰‡æ¢å¾©ä¸€èˆ¬çŸ©å½¢(éæ­£æ–¹å½¢) */
    @media (max-width:800px) {
      .diary-cards {
        grid-template-columns: 1fr;
        grid-template-rows: repeat(12, auto);
        gap: 14px 0;
        max-width: 420px;
      }
      .container.diary {
        padding: 0 2vw;
      }
      .diary-card {
        aspect-ratio: unset;
        height: auto;
        min-height: 72px;
        padding: 18px 12px;
      }
    }
    @media (max-width:600px) {
      .diary-char-area .char-emoji {font-size: 1.5em;}
      .diary-progress-bg {height: 18px;}
      .diary-card {border-radius: 10px;}
      .diary-card .emoji {font-size:1.5em;}
      .diary-card .label {font-size:1em;}
    }
  </style>
</head>
<body>
  <div class="container diary">
    <div class="diary-char-area">
      <span class="char-emoji" id="diaryCharEmoji">ğŸ™‚</span>
    </div>
    <div class="diary-progress-bg">
      <div class="diary-progress-bar" id="progressBar"></div>
    </div>
    <form id="diaryForm" autocomplete="off">
      <div class="diary-cards" id="diaryCards"></div>
      <div class="diary-tip-bar" id="diaryTip">
        <span class="tip-emoji">ğŸ’¬</span>
        <span id="tipText">æ¯å¤©å‹¾é¸ä½ çš„ä½ç¢³è¡Œå‹•ï¼Œè§’è‰²è¡¨æƒ…æœƒéš¨é€²åº¦æ¢å·¦å³ç§»å‹•ï¼</span>
      </div>
      <button class="btn diary-submit" type="submit">âœ¨ çœ‹çœ‹æˆ‘çš„ä»Šæ—¥ç¢³è¶³è·¡ âœ¨</button>
    </form>
    <a class="back-link" href="index.html">â† å›é¦–é </a>
  </div>
  <script>
    // è¡Œç‚ºå¡è³‡æ–™ï¼ˆ12é …ï¼‰
    const actions = [
      {val:"walk",emoji:"ğŸš¶â€â™‚ï¸ğŸš´",txt:"é¨è…³è¸è»Šä¸Šå­¸/<br>æ­¥è¡Œ/ä¸Šç­"},
      {val:"bus",emoji:"ğŸšŒ",txt:"æ­ä¹˜å¤§çœ¾é‹è¼¸"},
      {val:"drive",emoji:"ğŸš—",txt:"è‡ªå·±é–‹è»Š/é¨æ©Ÿè»Š"},
      {val:"ac",emoji:"â„ï¸",txt:"å†·æ°£é–‹è¶…é2å°æ™‚"},
      {val:"beef",emoji:"ğŸ¥©",txt:"åƒç‰›è‚‰"},
      {val:"pork",emoji:"ğŸ–",txt:"åƒè±¬è‚‰"},
      {val:"chicken",emoji:"ğŸ—",txt:"åƒé›è‚‰"},
      {val:"vegetarian",emoji:"ğŸ¥—",txt:"ä¸€é¤åƒç´ "},
      {val:"recycle",emoji:"â™»ï¸",txt:"åšè³‡æºå›æ”¶"},
      {val:"plastic",emoji:"ğŸ¥¤",txt:"ä½¿ç”¨ä¸€æ¬¡æ€§<br>å¡‘è† é¤å…·"},
      {val:"bag",emoji:"ğŸ›ï¸",txt:"è‡ªå‚™è³¼ç‰©è¢‹"},
      {val:"handkerchief",emoji:"ğŸ§»",txt:"ç”¨æ‰‹å¸•ä»£æ›¿ç´™å·¾"}
    ];

    // è§’è‰²è¡¨æƒ…å®šç¾©(æ ¹æ“šåˆ†æ•¸)
    function getCharState(score) {
      if(score<=0) return {emoji:"ğŸ˜„"};
      if(score<=2) return {emoji:"ğŸ™‚"};
      return {emoji:"ğŸ˜…"};
    }
    // è¡Œç‚ºåˆ†æ•¸
    const actScore = {
      walk:-2, bus:-1, drive:2, ac:3, beef:2, pork:1, chicken:1, vegetarian:-1, recycle:-1,
      plastic:1, bag:-1, handkerchief:-1
    };

    // ç”Ÿæˆå¡ç‰‡
    const cards = document.getElementById('diaryCards');
    actions.forEach((a,i)=>{
      const div = document.createElement('div');
      div.className = "diary-card";
      div.innerHTML = `
        <input type="checkbox" name="actions" value="${a.val}" id="chk_${a.val}">
        <span class="emoji">${a.emoji}</span>
        <span class="label">${a.txt}</span>
      `;
      div.onclick = e=>{
        const cb = div.querySelector('input');
        cb.checked = !cb.checked;
        div.classList.toggle('selected', cb.checked);
        updateDiaryState();
      };
      cards.appendChild(div);
    });

    // é€²åº¦æ¢ã€è¡¨æƒ…ç§»å‹•ã€é‡‘å¥
    function updateDiaryState() {
      const cbs = Array.from(document.querySelectorAll('input[name="actions"]'));
      const checked = cbs.filter(cb=>cb.checked).map(cb=>cb.value);
      // é€²åº¦æ¢
      const percent = Math.round(checked.length / actions.length * 100);
      document.getElementById('progressBar').style.width = percent+"%";
      // è¡¨æƒ…
      let score = 0;
      checked.forEach(act=>score+=actScore[act]||0);
      const state = getCharState(score);
      const emoji = document.getElementById('diaryCharEmoji');
      emoji.textContent = state.emoji;
      // Emojiæ ¹æ“šé€²åº¦æ¢ç§»å‹•ï¼Œç¯„åœ5%~95%
      const minLeft = 5, maxLeft = 95;
      const left = minLeft + (maxLeft - minLeft) * (checked.length / actions.length);
      emoji.style.left = `calc(${left}% )`;
      // æç¤º
      const tips = [
        "é¸æ“‡æ­¥è¡Œæˆ–å¤§çœ¾é‹è¼¸ï¼Œåœ°çƒç¬‘é–‹æ‡·ï¼",
        "è‡ªå‚™è³¼ç‰©è¢‹+æ‰‹å¸•ï¼Œå°ç´°ç¯€ä¹Ÿèƒ½æ•‘åœ°çƒï¼",
        "å†·æ°£å°‘å¹ä¸€å°æ™‚ï¼Œçœç¢³åˆçœéŒ¢ï½",
        "ä¸€é¤åƒç´ ï¼Œæ¸›ç¢³1000gï¼Œè¶…æœ‰æ„Ÿï¼",
        "åšè³‡æºå›æ”¶ï¼Œæ˜¯ä½ æˆ‘æœ€ç°¡å–®çš„ä½ç¢³è¡Œå‹•",
        "ç’°ä¿å¾æ—¥å¸¸åšèµ·ï¼Œè§’è‰²ä¹Ÿæœƒé™ªä½ ä¸€èµ·é€²æ­¥ï¼"
      ];
      document.getElementById('tipText').textContent = tips[Math.floor(Math.random()*tips.length)];
      document.getElementById('diaryTip').style.background = ["#fffde7","#e3f2fd","#f1f8e9","#fce4ec","#f3e5f5"][checked.length%5];
    }
    updateDiaryState();

    // è¡¨å–®é€å‡º
    document.getElementById('diaryForm').addEventListener('submit', function(e){
      e.preventDefault();
      const checked = Array.from(document.querySelectorAll('input[name="actions"]')).filter(cb=>cb.checked).map(cb=>cb.value);
      localStorage.setItem('carbonActions', JSON.stringify(checked));
      window.location.href = "result.html";
    });
  </script>
</body>
</html>